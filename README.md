**YM ‚Üí Lidarr**

[![CII Best Practices](https://bestpractices.coreinfrastructure.org/projects/11085/badge)](https://bestpractices.coreinfrastructure.org/projects/11085)
[![OpenSSF Scorecard](https://api.securityscorecards.dev/projects/github.com/MrSaerus/ym2lidarr/badge)](https://securityscorecards.dev/viewer/?uri=github.com/MrSaerus/ym2lidarr)
[![GitHub Release](https://img.shields.io/github/v/release/MrSaerus/ym2lidarr?sort=semver&label=Release%20latest)](https://github.com/MrSaerus/ym2lidarr/releases)
[![Release](https://github.com/MrSaerus/ym2lidarr/actions/workflows/release.yml/badge.svg)](https://github.com/MrSaerus/ym2lidarr/actions/workflows/release.yml)
[![Tests (unit)](https://github.com/MrSaerus/ym2lidarr/actions/workflows/tests-unit.yml/badge.svg?branch=main)](https://github.com/MrSaerus/ym2lidarr/actions/workflows/tests-unit.yml)

## Docker
[![YM2LIDARR-API](https://badgen.net/docker/size/saerus/ym2lidarr-api?icon=docker&label=API)](https://hub.docker.com/r/saerus/ym2lidarr-api/)
[![YM2LIDARR-WEB](https://badgen.net/docker/size/saerus/ym2lidarr-web?icon=docker&label=WEB)](https://hub.docker.com/r/saerus/ym2lidarr-web/)
[![YM2LIDARR-PyPROXY](https://badgen.net/docker/size/saerus/ym2lidarr-pyproxy?icon=docker&label=PyPROXY)](https://hub.docker.com/r/saerus/ym2lidarr-pyproxy/)
[![YM2LIDARR-SINGLE](https://badgen.net/docker/size/saerus/ym2lidarr-single?icon=docker&label=SINGLE)](https://hub.docker.com/r/saerus/ym2lidarr-single/)

## –û–ø–∏—Å–∞–Ω–∏–µ
–°–µ—Ä–≤–∏—Å, –∑–∞–±–∏—Ä–∞–µ—Ç **–ª–∞–π–∫–∏ –∏–∑ –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∏** –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ **Lidarr** (–∫–∞—Å—Ç–æ–º-–ª–∏—Å—Ç –∞—Ä—Ç–∏—Å—Ç–æ–≤ –∏–ª–∏ —Ä–µ–ª–∏–∑-–≥—Ä—É–ø–ø—ã –∞–ª—å–±–æ–º–æ–≤).

## Screenshots

1. Main
![Index](images/Main.png)
2. Lidarr
![Lidarr](images/Lidarr.png)
3. Yandex
![Yandex](images/Yandex.png)
4. Custom
![Custom](images/Custom.png)
5. Unified
![Unified](images/Unified.png)
6. Settings
![Settings](images/Settings.png)
7. Backup
![Backup](images/Backup.png)
8. Logs
![Logs](images/Logs.png)

üöÄ **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**

- –°–±–æ—Ä –ª–∞–π–∫–Ω—É—Ç—ã—Ö **—Ç—Ä–µ–∫–æ–≤/–∞–ª—å–±–æ–º–æ–≤** –∏–∑ –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∏.
- –ú–∞—Ç—á–∏–Ω–≥ —Å **MusicBrainz** (–∞—Ä—Ç–∏—Å—Ç—ã ‚Üí MBID, –∞–ª—å–±–æ–º—ã ‚Üí release-group MBID).
- **Push –≤ Lidarr**: –∞—Ä—Ç–∏—Å—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ –∞–ª—å–±–æ–º—ã.
- –≠–∫—Å–ø–æ—Ä—Ç **JSON/CSV/MD** (–ø—Ä—è–º–æ –∏–∑ –ë–î, –±–µ–∑ —Ñ–∞–π–ª–æ–≤-–∫—É—Å–∫–æ–≤).
- –í–∫–ª–∞–¥–∫–∏ **Found / Unmatched** —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏ –∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ MB/Yandex Music.
- **Live Logs** ‚Äî –æ–Ω–ª–∞–π–Ω–æ–≤—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ/–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞.
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–æ —Ñ—Ä–æ–Ω—Ç–µ**: —Ç–æ–∫–µ–Ω—ã/–∫–ª—é—á–∏, —Ä–µ–∂–∏–º—ã, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, —á–∞—Å—Ç–æ—Ç—ã.
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫** (cron) –¥–ª—è –Ø–Ω–¥–µ–∫—Å-—Å–∏–Ω–∫–∞, –õ–∏–¥–∞—Ä—Ä-–ø—É—à–∞ –∏ –±—ç–∫–∞–ø–æ–≤ (–≤–∫–ª/–≤—ã–∫–ª).
- **–ë—ç–∫–∞–ø—ã SQLite** (VACUUM INTO) —Å —Ä–æ—Ç–∞—Ü–∏–µ–π.
- **–ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–∏–Ω–∫–∞: Telegram –∏–ª–∏ Webhook.
- **Health-checks** –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (web/api/pyproxy).
- –í—Å—ë —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **SQLite** (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∫—ç—à–∏, –∫–∞–Ω–¥–∏–¥–∞—Ç—ã, –ª–æ–≥–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã).


üß© **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

```
Next.js (web, 3000)  ‚îÄ‚îÄ>  Node.js API (4000)  ‚îÄ‚îÄ>  SQLite (Prisma)
```

- **web** ‚Äî Next.js 14, UI –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.
- **api** ‚Äî Express + Prisma, –≤—Å—è –ª–æ–≥–∏–∫–∞, cron, —ç–∫—Å–ø–æ—Ä—Ç, –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **pyproxy** ‚Äî FastAPI, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –Ø–ú (–æ–±—Ö–æ–¥–∏—Ç SmartCaptcha).

üì¶ **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)**
–¢—Ä–µ–±—É–µ—Ç—Å—è Docker –∏ docker compose v2.

```bash

# 1) —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
git clone <repo>
cd <repo>

# 2) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∑–∞–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env
cp .env.example .env

# 3) —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
docker compose up -d --build

# web: http://localhost:3000
# api: http://localhost:4000/health
# pyproxy: http://localhost:8080/health
```

**–ü—Ä–∏–º–µ—Ä** `docker-compose.yml`

```yaml
services:
  api:
    build:
      context: .
      dockerfile: docker/api.Dockerfile
    environment:
      - NODE_ENV=production
      - DATABASE_URL=file:/app/data/app.db
      - YA_PYPROXY_URL=http://pyproxy:8080
      - MB_RECHECK_HOURS=168
    ports:
      - '4000:4000'
    volumes:
      - db:/app/data
    healthcheck:
      test: ['CMD-SHELL', 'curl -fsS http://localhost:4000/health || exit 1']
      interval: 30s
      timeout: 5s
      retries: 3
    depends_on:
      - pyproxy

  web:
    build:
      context: .
      dockerfile: docker/web.Dockerfile
    environment:
      - NEXT_PUBLIC_API_BASE=http://localhost:4000
      - NODE_ENV=production
    ports:
      - '3000:3000'
    healthcheck:
      test: ['CMD-SHELL', 'curl -fsS http://localhost:3000/health || exit 1']
      interval: 30s
      timeout: 5s
      retries: 3
    depends_on:
      - api

  pyproxy:
    build:
      context: apps/pyproxy
      dockerfile: Dockerfile
    ports:
      - '8080:8080'
    healthcheck:
      test: ['CMD-SHELL', 'curl -fsS http://localhost:8080/health || exit 1']
      interval: 30s
      timeout: 5s
      retries: 3

volumes:
  db:
```

üßë‚Äçüíª **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**

–¢—Ä–µ–±—É–µ—Ç—Å—è Node.js ‚â• 18.17 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 20.x) –∏ npm.

```bash
npm i

# prisma
export DATABASE_URL="file:./data/app.db"
npx prisma generate
npx prisma migrate dev --name init

# dev-—Å–µ—Ä–≤–µ—Ä—ã (–≤ —Ä–∞–∑–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö):
npm run dev:api   # http://localhost:4000
npm run dev:web   # http://localhost:3000

# pyproxy (python >= 3.10)
cd apps/pyproxy
pip install -r requirements.txt
uvicorn main:app --host 0.0.0.0 --port 8080
```

–í –ø—Ä–æ–¥–µ/–≤ –¥–æ–∫–µ—Ä–µ Prisma –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—É—Ç—å file:/app/data/app.db.

‚öôÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–≤–æ —Ñ—Ä–æ–Ω—Ç–µ)**
**Yandex Music**

- Driver: pyproxy (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ native. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è pyproxy.
- PyProxy URL: –Ω–∞–ø—Ä–∏–º–µ—Ä, http://pyproxy:8080.
- Yandex token: OAuth —Ç–æ–∫–µ–Ω –Ø–ú.
- Sync cron (Yandex): CRON-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –ø—É—Å—Ç–æ (–æ—Ç–∫–ª—é—á–µ–Ω–æ).

**Lidarr**

- Push target: artists (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ albums (release-groups).
- Lidarr URL: http://lidarr:8686
- Lidarr API key: –∫–ª—é—á API.
- Sync cron (Lidarr push): CRON –∏–ª–∏ –ø—É—Å—Ç–æ (–æ—Ç–∫–ª—é—á–µ–Ω–æ).

**Backups (SQLite)**

- Enabled: –≤–∫–ª/–≤—ã–∫–ª.
- Cron: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞.
- Retention (files): —Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –¥–µ—Ä–∂–∞—Ç—å.
- Directory: –∫–∞—Ç–∞–ª–æ–≥ –±—ç–∫–∞–ø–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é /app/data/backups).
- –ë—ç–∫–∞–ø –¥–µ–ª–∞–µ—Ç –∞—Ç–æ–º–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç —á–µ—Ä–µ–∑ VACUUM INTO.

**Notifications**

- Type: none / telegram / webhook.
- Telegram:
  - Telegram Bot Token
  - Telegram Chat ID
- Webhook:
  - Webhook URL
  - Webhook Secret (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ HMAC-SHA256 –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ X-Signature).

üñ•Ô∏è **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
**Overview** ‚Äî –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∑–∞–ø—É—Å–∫ —Å–∏–Ω–∫–∞/–ø—É—à–∞.
**Found** ‚Äî —Å–º–∞—Ç—á–µ–Ω–Ω—ã–µ –∞—Ä—Ç–∏—Å—Ç—ã/–∞–ª—å–±–æ–º—ã (—Å—Å—ã–ª–∫–∏ –Ω–∞ MB –∏ YM).
**Unmatched** ‚Äî –Ω–µ —Å–º–∞—Ç—á–µ–Ω–Ω—ã–µ, –∫–∞–Ω–¥–∏–¥–∞—Ç—ã c –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π, —Å—Å—ã–ª–∫–∏ –Ω–∞ MB/YM.
**Live Logs** ‚Äî –ª–æ–≥–∏ —Ç–µ–∫—É—â–µ–≥–æ/–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞, –æ–Ω–ª–∞–π–Ω-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.
**Settings** ‚Äî –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Ç–µ—Å—Ç—ã –∫–æ–Ω–Ω–µ–∫—Ç–æ–≤, –∑–∞–ø—É—Å–∫ –±—ç–∫–∞–ø–∞, —Å—Å—ã–ª–∫–∏ –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç.

üîÅ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**

1. –°–±–æ—Ä –ª–∞–π–∫–æ–≤ —É –Ø–ú —á–µ—Ä–µ–∑ pyproxy (–∏–ª–∏ native).
2. –ò–∑ —Ç—Ä–µ–∫–æ–≤ —Å–æ–±–∏—Ä–∞–µ–º –∞—Ä—Ç–∏—Å—Ç–æ–≤ –∏ –∞–ª—å–±–æ–º—ã (—É–Ω–∏–∫–∞–ª—å–Ω–æ).
3. –ú–∞—Ç—á–∏–Ω–≥ —Å MusicBrainz c –∫—ç—à–µ–º –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤.
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤/–∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤/–∫—ç—à–∞ –≤ SQLite.
5. –ü—É—à –≤ Lidarr (–∞—Ä—Ç–∏—Å—Ç—ã/–∞–ª—å–±–æ–º—ã ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è).
6. Live-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ë–î, –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.

**Cool-down —Ä–µ–º–∞—Ç—á–∏–Ω–≥–∞**
–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –º–∞—Ç—á–∏–Ω–≥ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ MB_RECHECK_HOURS (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 168 —á–∞—Å–æ–≤ / 7 –¥–Ω–µ–π).
–ú–æ–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å Run (force) ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç cool-down.

# üîó **API**

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ–¥ `/api/*`, –∫—Ä–æ–º–µ –±–ª–æ–∫–∞ **Runs**, –≥–¥–µ –¥–æ—Å—Ç—É–ø–Ω–æ –∏ –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞.

---

## Health

- **GET `/api/health`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–≤–æ—Å—Ç–∏ `{ ok: true }`.

---

## Settings

- **GET `/api/settings`** ‚Äî –ø–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
- **GET `/api/settings/scheduler`** ‚Äî —Å—Ç–∞—Ç—É—Å cron-–¥–∂–æ–±.
- **POST `/api/settings`** ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
- **PUT `/api/settings`** ‚Äî —Ç–æ –∂–µ, —á—Ç–æ `POST`.

### –¢–µ—Å—Ç—ã

- **POST `/api/settings/test/yandex`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω Yandex.
- **POST `/api/settings/test/lidarr`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Lidarr API, –ø–æ–¥—Ç—è–Ω—É—Ç—å –¥–µ—Ñ–æ–ª—Ç—ã.
- **POST `/api/settings/lidarr/defaults`** ‚Äî –ø–æ–¥—Ç—è–Ω—É—Ç—å –¥–µ—Ñ–æ–ª—Ç—ã Lidarr (—Å –æ–ø—Ü–∏–µ–π overwrite).

---

## Stats

- **GET `/api/stats`** ‚Äî —Å–≤–æ–¥–∫–∞ –ø–æ Yandex, Lidarr –∏ Custom, –ø–æ—Å–ª–µ–¥–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∞–∫—Ç–∏–≤–Ω—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–≥–æ–Ω—ã.

---

## Export

- **GET `/api/export/artists.json`** ‚Äî –∞—Ä—Ç–∏—Å—Ç—ã –≤ JSON (MBID).
- **GET `/api/export/albums.json`** ‚Äî –∞–ª—å–±–æ–º—ã –≤ JSON (ReleaseGroupMBID).
- **GET `/api/export/artists.csv`**, **GET `/api/export/albums.csv`** ‚Äî CSV –¥–ª—è Excel.
- **GET `/api/export/artists.md`**, **GET `/api/export/albums.md`** ‚Äî Markdown —Ç–∞–±–ª–∏—Ü—ã.

---

## Backup

- **GET `/api/backup/list`** ‚Äî —Å–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤.
- **POST `/api/backup/run`** ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å –±—ç–∫–∞–ø —Å–µ–π—á–∞—Å.

---

## Unified (–æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏)

- **GET `/api/unified/artists`** ‚Äî –∞—Ä—Ç–∏—Å—Ç—ã Yandex+Lidarr —Å MB/Lidarr/Yandex —Å—Å—ã–ª–∫–∞–º–∏.
- **GET `/api/unified/albums`** ‚Äî –∞–ª—å–±–æ–º—ã Yandex+Lidarr —Å MB/Lidarr/Yandex —Å—Å—ã–ª–∫–∞–º–∏.

---

## Yandex

### –†—É—á–Ω—ã–µ —Å—Ç–∞—Ä—Ç—ã

- **POST `/api/yandex/pull-all`** ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–∞–π–∫–∏ –≤ –∫—ç—à.
- **POST `/api/yandex/match`** `{ target, force? }` ‚Äî –º–∞—Ç—á–∏–Ω–≥ –∫ MB.
- **POST `/api/yandex/push`** `{ target }` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Lidarr.

### –°–ø–∏—Å–∫–∏

- **GET `/api/yandex/artists`** ‚Äî –∞—Ä—Ç–∏—Å—Ç—ã –∏–∑ –∫—ç—à–∞ Yandex.
- **GET `/api/yandex/albums`** ‚Äî –∞–ª—å–±–æ–º—ã –∏–∑ –∫—ç—à–∞ Yandex.

---

## Lidarr

### Artists

- **GET `/api/lidarr/artists`** ‚Äî –∞—Ä—Ç–∏—Å—Ç—ã –∏–∑ –∫—ç—à–∞ Lidarr.
- **POST `/api/lidarr/artist/:id/refresh`** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –∞—Ä—Ç–∏—Å—Ç–∞.

### Albums

- **GET `/api/lidarr/albums`** ‚Äî –∞–ª—å–±–æ–º—ã –∏–∑ –∫—ç—à–∞ Lidarr.
- **POST `/api/lidarr/album/:id/refresh`** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –∞–ª—å–±–æ–º–∞.
- **POST `/api/lidarr/resync`** ‚Äî –ø–æ–ª–Ω—ã–π —Ä–µ—Å–∏–Ω–∫ –∞—Ä—Ç–∏—Å—Ç–æ–≤ –∏ –∞–ª—å–±–æ–º–æ–≤.

---

## Custom Artists

- **GET `/api/custom-artists`** ‚Äî —Å–ø–∏—Å–æ–∫ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∞—Ä—Ç–∏—Å—Ç–æ–≤.
- **POST `/api/custom-artists`** `{ names: string[] }` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∞—Ä—Ç–∏—Å—Ç–æ–≤.
- **PATCH `/api/custom-artists/:id`** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∏–º—è –∏–ª–∏ MBID.
- **DELETE `/api/custom-artists/:id`** ‚Äî —É–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–∏—Å—Ç–∞.

### –ú–∞—Ç—á–∏–Ω–≥

- **POST `/api/custom-artists/:id/match`** ‚Äî –º–∞—Ç—á–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –∞—Ä—Ç–∏—Å—Ç–∞.
- **POST `/api/custom-artists/match-all`** ‚Äî –º–∞—Ç—á–∏–Ω–≥ –≤—Å–µ—Ö.

---

## Sync (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å–Ω—ã–µ —Ä—É—á–Ω—ã–µ —Å—Ç–∞—Ä—Ç—ã)

- **POST `/api/sync/yandex/pull`** ‚Äî Yandex Pull.
- **POST `/api/sync/lidarr/pull`** ‚Äî Lidarr Pull.
- **POST `/api/sync/match`** ‚Äî –º–∞—Ç—á–∏–Ω–≥.
- **POST `/api/sync/lidarr`** ‚Äî –ø—É—à –≤ Lidarr.
- **POST `/api/sync/custom/match`** ‚Äî –º–∞—Ç—á–∏–Ω–≥ custom –∞—Ä—Ç–∏—Å—Ç–æ–≤.
- **POST `/api/sync/custom/push`** ‚Äî –ø—É—à custom –∞—Ä—Ç–∏—Å—Ç–æ–≤ –≤ Lidarr.
- **POST `/api/sync/yandex/pull-all`** ‚Äî –ø–æ–ª–Ω—ã–π Pull.
- **POST `/api/sync/yandex/match`** ‚Äî –º–∞—Ç—á–∏–Ω–≥ Yandex.
- **POST `/api/sync/yandex/push`** ‚Äî –ø—É—à Yandex.

### Runs –≤–Ω—É—Ç—Ä–∏ `/sync`

- **GET `/api/sync/runs`** ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø—Ä–æ–≥–æ–Ω—ã.
- **GET `/api/sync/runs/:id`** ‚Äî –¥–µ—Ç–∞–ª–∏.
- **GET `/api/sync/runs/:id/logs`** ‚Äî –ª–æ–≥–∏.
- **POST `/api/sync/runs/:id/stop`** ‚Äî –º—è–≥–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞.

---

## Runs & Logs (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å; –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è —Å `/api`)

- **GET `/runs?limit=‚Ä¶`** ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–ø—É—Å–∫–æ–≤.
- **GET `/runs/latest`** ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫.
- **GET `/runs/:id`** ‚Äî –¥–µ—Ç–∞–ª–∏ –∑–∞–ø—É—Å–∫–∞.
- **GET `/runs/:id/logs`** ‚Äî –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞.
- **POST `/runs/:id/stop`** ‚Äî –º—è–≥–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞.

> üîí –î–ª—è UI —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏:
> - `GET /api/runs?limit=30`
> - `GET /api/runs/:id/logs`
> - `GET /api/stats`


üîê **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                     | –ü—Ä–∏–º–µ—Ä                                   |
|--------------------------|----------------------------------------------------------------|------------------------------------------|
| **PORT_API**             | –ü–æ—Ä—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ API                                          | `PORT_API=4000`                          |
| **YA_PYPROXY_URL**       | URL PyProxy-—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –Ø.–ú—É–∑—ã–∫–µ     | `YA_PYPROXY_URL=http://pyproxy:8081`     |
| **YANDEX_MUSIC_TOKEN**   | –û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∏                      | `YANDEX_MUSIC_TOKEN=Y0_AgAAA...`         |
| **YM_TOKEN**             | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∏–º—è —Ç–æ–∫–µ–Ω–∞ –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∏                       | `YM_TOKEN=Y0_AgAAA...`                   |
| **MB_RECHECK_HOURS**     | –ö–æ–ª-–≤–æ —á–∞—Å–æ–≤ –¥–ª—è –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π MusicBrainz       | `MB_RECHECK_HOURS=168`                   |
| **YA_UA**                | –ö–∞—Å—Ç–æ–º–Ω—ã–π User-Agent –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–µ             | `YA_UA=MyApp/1.0 (Linux; x86_64)`        |
| **YA_CLIENT**            | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∏                           | `YA_CLIENT=Android/240213`               |
| **NEXT_PUBLIC_API_BASE** | –ë–∞–∑–æ–≤—ã–π URL API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Next.js, –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)  | `NEXT_PUBLIC_API_BASE=https://host/api`  |


`–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —É–∂–µ –≤–æ —Ñ—Ä–æ–Ω—Ç–µ (Settings) ‚Äî –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ SQLite.`

üß™ **–ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**Telegram**: —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–∏–Ω–∫–∞ (ok/error) —Å –∫—Ä–∞—Ç–∫–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π.

**Webhook**: POST JSON –≤–∏–¥–∞:

```json
{
  "source": "yandex",
  "status": "ok",
  "runId": 123,
  "stats": { "...": "..." }
}
```

–ï—Å–ª–∏ –∑–∞–¥–∞–Ω `webhookSecret`, –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Signature: sha256=<HMAC>`.

üß∞ **–¢—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥**

- **403 SmartCaptcha –æ—Ç –Ø–Ω–¥–µ–∫—Å–∞**

      –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä–∞–π–≤–µ—Ä pyproxy (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ) –∏ –±–µ–ª—ã–π IP (–Ω–µ DC/VPN).

  –í native –≤–æ–∑–º–æ–∂–Ω—ã –±–ª–æ–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –Ø–ú.

- **Next.js —Ä—É–≥–∞–µ—Ç—Å—è –Ω–∞ Node**

  –ù—É–∂–µ–Ω Node ‚â• 18.17 (–ª—É—á—à–µ 20.x).

- **Prisma/SQLite/openssl –≤ alpine-–æ–±—Ä–∞–∑–∞—Ö**

  –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Debian-based –æ–±—Ä–∞–∑—ã. –ï—Å–ª–∏ —Å–æ–±–∏—Ä–∞–µ—Ç–µ —Å–≤–æ—ë ‚Äî —Å—Ç–∞–≤—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π OpenSSL.

- **–ü—É—Å—Ç—ã–µ —Å–ø–∏—Å–∫–∏ Found/Unmatched**

  –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∏–Ω–∫ –ø—Ä–æ—à—ë–ª (Overview ‚Üí Run) –∏ —á—Ç–æ —Ñ—Ä–æ–Ω—Ç —Å—Ç—É—á–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–æ—É—Ç—ã /api/found –∏ /api/unmatched.

ü§ù **Contributing**

**PR –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è**: –±–∞–≥—Ñ–∏–∫—Å—ã, —É–ª—É—á—à–µ–Ω–∏—è UI, –Ω–æ–≤—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã, –¥–æ–ø. —Ñ–æ—Ä–º–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞.
**–ü–µ—Ä–µ–¥ PR**: `npm i`, `npx prisma generate`, –ª–∏–Ω—Ç, —Å–±–æ—Ä–∫–∞ web/api, –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ–≥–æ–Ω –≤ docker compose.

üó∫Ô∏è **Roadmap**

- –í—ã–±–æ—Ä–æ—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤—Ä—É—á–Ω—É—é (assign MBID/RG).
- –ü–∞–∫–µ—Ç–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è/–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥—É–±–ª–µ–π.
- –°–∏–Ω—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤/–∞–ª—å–±–æ–º–æ–≤ –∏–∑ Lidarr –æ–±—Ä–∞—Ç–Ω–æ –≤ –Ø–ú (–∏–¥–µ—è).
- SSE/WebSocket –¥–ª—è live-–ª–æ–≥–æ–≤ (–≤–º–µ—Å—Ç–æ polling).
- –†–æ–ª–∏/–¥–æ—Å—Ç—É–ø—ã (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è).
- –ø–æ–∏—Å–∫/—Ñ–∏–ª—å—Ç—Ä –ø–æ –ª–æ–≥–∞–º (artist/album/level),
- —ç–∫—Å–ø–æ—Ä—Ç —Ç–µ–∫—É—â–µ–≥–æ –ª–æ–≥–∞ (NDJSON/CSV),
- –∞–≤—Ç–æ—Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ debug –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å ‚Äúcompact/verbose‚Äù,
- —Ä–µ—Ç–µ–Ω—à–Ω –¥–ª—è —Å—Ç–∞—Ä—ã—Ö runs (–æ—á–∏—Å—Ç–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É/–≤–æ–∑—Ä–∞—Å—Ç—É),
- –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–æ–±–∞–≤–ª—é –≤ ‚ÄúArtist skip‚Äù –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞ ‚Äî –¥–ª—è —ç—Ç–æ–≥–æ —Ä–∞—Å—à–∏—Ä—é —Å–±–æ—Ä –ª–∞–π–∫–æ–≤ –Ø.–ú—É–∑—ã–∫–∏ –¥–æ —Ç—Ä–µ–∫–æ–≤ –∏ –±—É–¥—É –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å data.song.
- –û–Ω–ª–∞–π–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ –±–∞–∑–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π –∏ –≤ –ª–æ–≥–∞—Ö
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ–Ω–æ–≤—É—é —Å–≤–µ—Ä–∫—É —Å —Å–∞–º–∏–º –õ–∏–¥–∞—Ä–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤ –∫–µ—à–µ –ø—É—Å—Ç–æ, –Ω–æ –≤ –õ–∏–¥–∞—Ä –¥–æ–±–∞–≤–∏–ª–∏ –≤—Ä—É—á–Ω—É—é)